{% extends 'TkUserBundle::frame.html.twig' %}

{% set group = app.user.currentMember.tgroup %}

{% block title %}   
<title> {{group.name}} </title>
{% endblock %}

{% block stylesheets %}
 {{ parent() }}
 <link href="{{ asset('css/group-settings.css') }}" rel="stylesheet" type="text/css">
 <link href="{{ asset('css/expenses.css') }}" rel="stylesheet" type="text/css">
{% endblock %}

{% block navbartitle %}
<div>
	<div id="title">
		<a href="{{ path('tk_group_homepage') }}" ><h3>{{ group.name|capitalize }}</h3></a>
	</div>
	{% if app.user.members|length > 1 %}
	<div id="caret">	
		<div class="dropdown">
		    <a class="dropdown-toggle" data-toggle="dropdown" href="#"><i class="icon-caret-down"></i></a>
		    <ul id="title-dropdown" class="dropdown-menu" role="menu" aria-labelledby="dLabel" >             
			    {% for member in app.user.members %}
			    <li><a href="{{ path('tk_group_switch_member', { 'id' : member.id, 'route' : app.request.attributes.get('_route') }) }}">{{ member.tgroup.name }}</a></li>
			    {% endfor %}
			     <li class="divider"></li>
			    <li><a href="{{ path('tk_group_new') }}">Start a new group</a></li>
			</ul>
		</div>
	</div>
	{% endif %}
</div>
{% endblock %}

{% block header %}
	<div id="second-row-big" class="row" style="position: relative">
		<div id="group" class="span8 offset2">
			<div id="pictures">
				{% for member in group.members %}
				<div class="member">
					{% if member.user == app.user %}
					<a href="{{ path('tk_user_homepage') }}">
						{% if member.user.facebookId %}
						<img src="http://graph.facebook.com/{{member.user.facebookId}}/picture?width=100&height=100" class="img-circle" alt="{{ member.name }}" style="position: relative">
						{% else %}
						<img src="{{ asset(member.user.picture.path) }}" class="img-circle" alt="{{ member.name }}" style="position: relative">
						{% endif %}
						<p style="color: rgb(121,136,151);text-shadow:  white 0px 1px 0px;">{{ member.name }}</p>
					</a>
					{% elseif member.user %}
					<a data-target="memberProfileModal" data-id="{{member.id}}" style="cursor: pointer">
						{% if member.user.facebookId %}
						<img src="http://graph.facebook.com/{{member.user.facebookId}}/picture?width=100&height=100" class="img-circle" alt="{{ member.name }}" style="position: relative">
						{% else %}
						<img src="{{ asset(member.user.picture.path) }}" class="img-circle" alt="{{ member.name }}" style="position: relative">
						{% endif %}
						<p style="color: rgb(121,136,151);text-shadow:  white 0px 1px 0px;">{{ member.name }}</p>
					</a> 
					{% else %}
					<a data-target="memberProfileModal" data-id="{{member.id}}" style="cursor: pointer">
						
							<img src="{{ asset('uploads/profile-pictures/profile-pic.png') }}" class="img-circle" alt="{{ member.name }}" style="position: relative">
							<p style="color: rgb(121,136,151);text-shadow: white 0px 1px 0px;">{{ member.name }}</p>
						
					</a>
					{% endif %}
				</div>
				{% endfor %}
				<div class="member" style="vertical-align:top">
					<a href="{{ path('tk_group_add_members') }}">
						<img src="{{ asset('img/Frame/add-member.png') }}" class="img-circle" alt="Add Member" style="position: relative; ">
						<p></p>
					</a>
				</div>
				<div id="group-flash-messages">
				</div>
			</div>
		</div>
		<a id="toggle-button"style="cursor: pointer">hide members</a>
	</div>

	<!-- modal for seing the profile of member -->
	<div id="memberProfileModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<!-- content of the modal loaded via ajax -->
	</div>

{% endblock %}


{% block selectionmenu %}
	<div id="navbar-row" class="selection-menu" style="padding-top:0">
		<div class="container" style="height:100%;">
			<div  class="row" style="height:100%;">
				<div class="span6 offset3" style="height:100%; text-align: center;">
					<div id="navbar-expenses" style="height:100%; display: inline-block; width: 24%; text-align: center; padding-top: 5px; padding-bottom: 5px;">
						<a href="#">Expenses</a>
					</div>
					<div id="navbar-timeline" style="height:100%; display: inline-block; width: 24%; text-align: center; padding-top: 5px; padding-bottom: 5px;">
						<a href="#">Dashboard</a>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script>
		var balances = {{ app.user.currentMember.tgroup.arrayBalances|json_encode|raw }};
	</script>
{% endblock %}

{% block javascripts %}
 	<script type='text/javascript' src="{{ asset('js/group.js') }}"></script>
{% endblock %}